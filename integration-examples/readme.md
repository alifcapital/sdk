# Integration Examples

–ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —ç–∫–≤–∞–π—Ä–∏–Ω–≥–æ–º Webcheckout –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —è–∑—ã–∫–∞—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
integration-examples/
‚îú‚îÄ‚îÄ go/               # –ü—Ä–∏–º–µ—Ä—ã –Ω–∞ Go
‚îú‚îÄ‚îÄ c#/               # –ü—Ä–∏–º–µ—Ä—ã –Ω–∞ C#
‚îú‚îÄ‚îÄ php/              # –ü—Ä–∏–º–µ—Ä—ã –Ω–∞ PHP
‚îî‚îÄ‚îÄ readme.md         # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

–í—Å–µ –ø—Ä–∏–º–µ—Ä—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–Ω—É—é —Ä–∞–±–æ—á—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –¥–ª—è:
1. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏**
2. **–¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤**
3. **–ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å –ø–ª–∞—Ç–µ–∂–∏**
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ Callback —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

–ö–∞–∂–¥—ã–π —è–∑—ã–∫ –∏–º–µ–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –ª–æ–≥–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

### Go
```
go/
‚îú‚îÄ‚îÄ client.go      # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–µ–Ω—Ç API
‚îú‚îÄ‚îÄ models.go      # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (request/response)
‚îú‚îÄ‚îÄ token.go       # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HMAC SHA256 —Ç–æ–∫–µ–Ω–æ–≤
‚îî‚îÄ‚îÄ callback.go    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ callback —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```

### C#
```
c#/
‚îú‚îÄ‚îÄ AlifClient.cs          # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–µ–Ω—Ç API (async/await)
‚îú‚îÄ‚îÄ Models.cs              # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö —Å JSON –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
‚îú‚îÄ‚îÄ TokenGenerator.cs      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HMAC SHA256 —Ç–æ–∫–µ–Ω–æ–≤
‚îî‚îÄ‚îÄ CallbackHandlers.cs    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ callback —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```

### PHP
```
php/
‚îú‚îÄ‚îÄ AlifClient.php         # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–µ–Ω—Ç API (cURL)
‚îú‚îÄ‚îÄ TokenGenerator.php     # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HMAC SHA256 —Ç–æ–∫–µ–Ω–æ–≤
‚îú‚îÄ‚îÄ CallbackHandlers.php   # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ callback —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îî‚îÄ‚îÄ APIException.php       # –ò—Å–∫–ª—é—á–µ–Ω–∏—è API
```

---

## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤

–í—Å–µ –ø—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç **–¥–≤—É—Ö—ç—Ç–∞–ø–Ω—É—é** –≥–µ–Ω–µ—Ä–∞—Ü–∏—é HMAC SHA256 —Ç–æ–∫–µ–Ω–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

```
1. hashedPassword = HMAC_SHA256(terminalPassword, terminalID)
2. token = HMAC_SHA256(dataToSign, hashedPassword)
```

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–¥–ø–∏—Å–∏

**–î–ª—è –ø–ª–∞—Ç–µ–∂–µ–π:**
```
dataToSign = terminalID + orderID + amount + callbackURL
```

**–î–ª—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏:**
```
dataToSign = terminalID + phone + gate
```

**–î–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏:**
```
dataToSign = terminalID + transactionID + amount
```

**–î–ª—è VSA/MCR –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:**
```
dataToSign = terminalID + parentTransactionID
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç:
- HTTP —Å—Ç–∞—Ç—É—Å—ã (200, 208, 400, 401, 403, 500)
- Response –∫–æ–¥—ã –∏–∑ API
- –í—ã–±—Ä–∞—Å—ã–≤–∞—é—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

### Callback handlers

–ü—Ä–∏–º–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç–æ–¥–∞ (—Ç–æ–ª—å–∫–æ POST)
- –ü–∞—Ä—Å–∏–Ω–≥ JSON
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
- –í–æ–∑–≤—Ä–∞—Ç HTTP 200 OK

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### Go

```go
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
client := NewClient(
    "https://web.alif.tj",
    "your_terminal_id",
    "your_terminal_password",
)

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–∞
req := PaymentRequest{
    OrderID:     "ORDER_123",
    Amount:      "100.50",
    CallbackURL: "https://yourdomain.com/callback",
    ReturnURL:   "https://yourdomain.com/success",
    Gate:        "korti_milli",
}

resp, err := client.InitiatePayment(req)
if err != nil {
    log.Fatal(err)
}

// –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ resp.URL
```

### C#

```csharp
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
var client = new AlifClient(
    "https://web.alif.tj",
    "your_terminal_id",
    "your_terminal_password"
);

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–∞
var request = new PaymentRequest
{
    OrderID = "ORDER_123",
    Amount = "100.50",
    CallbackURL = "https://yourdomain.com/callback",
    ReturnURL = "https://yourdomain.com/success",
    Gate = "korti_milli"
};

var response = await client.InitiatePaymentAsync(request);

// –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ response.URL
```

### PHP

```php
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
$client = new AlifClient(
    'https://web.alif.tj',
    'your_terminal_id',
    'your_terminal_password'
);

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–∞
$request = [
    'order_id' => 'ORDER_123',
    'amount' => '100.50',
    'callback_url' => 'https://yourdomain.com/callback',
    'return_url' => 'https://yourdomain.com/success',
    'gate' => 'korti_milli'
];

$response = $client->initiatePayment($request);

// –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ $response['url']
```

---

## –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### 1. –§–æ—Ä–º–∞—Ç —Å—É–º–º—ã
–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **—Å—Ç—Ä–æ–∫—É** —Å **—Ä–æ–≤–Ω–æ 2 –∑–Ω–∞–∫–∞–º–∏** –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π:
```
‚úÖ "100.50"
‚úÖ "1500.00"
‚ùå 100.5
‚ùå "100.5"
‚ùå 100
```

### 2. –£–Ω–∏–∫–∞–ª—å–Ω—ã–π Order ID
–ö–∞–∂–¥—ã–π –ø–ª–∞—Ç–µ–∂ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å **—É–Ω–∏–∫–∞–ª—å–Ω—ã–π** `order_id`. –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å —Ç–µ–º –∂–µ `order_id` –≤–µ—Ä–Ω—ë—Ç –æ—à–∏–±–∫—É 208 (–î—É–±–ª–∏–∫–∞—Ç).

### 3. HTTPS –¥–ª—è Callback
–í production **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è `callback_url`.

### 4. –û—Ç–≤–µ—Ç –Ω–∞ Callback
–í—Å–µ–≥–¥–∞ –æ—Ç–≤–µ—á–∞–π—Ç–µ **HTTP 200 OK** –Ω–∞ callback –∑–∞–ø—Ä–æ—Å—ã, –∏–Ω–∞—á–µ —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É.

### 5. Header `gate`
–î–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π header `gate`:
- `korti_milli` - –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `wallet` - Alif Wallet
- `salom` - —Ä–∞—Å—Å—Ä–æ—á–∫–∞
- `invoice` - –Ω–∞–ª–∏—á–Ω—ã–µ
- `vsa` - VISA
- `mcr` - Mastercard
- `cybersource_checkout` - Cybersource

### 6. Marketplace header
–î–ª—è marketplace –ø–ª–∞—Ç–µ–∂–µ–π **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –¥–æ–±–∞–≤—å—Ç–µ header:
```
isMarketPlace: true
```

### 7. –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è
–î–ª—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ prefix `tokenization_` –≤ gate:
- `tokenization_korti_milli`
- `tokenization_wallet`
- `tokenization_salom`
- `tokenization_procard` (Visa/Mastercard)

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –°—Ç–∞—Ç—É—Å—ã –ø–ª–∞—Ç–µ–∂–µ–π

| –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –§–∏–Ω–∞–ª—å–Ω—ã–π |
|--------|----------|-----------|
| `ok` | –£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à—ë–Ω | –î–∞ |
| `pending` | –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã | –ù–µ—Ç |
| `to_approve` | –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ | –ù–µ—Ç |
| `failed` | –ù–µ —É–¥–∞–ª—Å—è | –î–∞ |
| `canceled` | –û—Ç–º–µ–Ω—ë–Ω | –î–∞ |

### –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤ API

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| 200 | –£—Å–ø–µ—à–Ω–æ |
| 208 | –î—É–±–ª–∏–∫–∞—Ç (order_id —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç) |
| 400 | –ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å |
| 401 | –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω) |
| 403 | –î–æ—Å—Ç—É–ø –æ—Ç–∫–∞–∑–∞–Ω (–Ω–µ–≤–µ—Ä–Ω—ã–π terminal key) |
| 500 | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ |

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ credentials
–ó–∞–º–µ–Ω–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ:
- `baseURL` - URL API (–∞–∫—Ç—É–∞–ª—å–Ω—ã–π url —Å–º. –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)
- `terminalID` - –≤–∞—à ID —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
- `terminalPassword` - –≤–∞—à –ø–∞—Ä–æ–ª—å —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
---
